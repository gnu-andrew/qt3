<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- /home/espenr/tmp/qt-3.3.8-espenr-2499/qt-x11-free-3.3.8/extensions/activeqt/container/qaxwidget.cpp:1336 -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>QAxWidget Class</title>
<style type="text/css"><!--
fn { margin-left: 1cm; text-indent: -1cm; }
a:link { color: #004faf; text-decoration: none }
a:visited { color: #672967; text-decoration: none }
body { background: #ffffff; color: black; }
--></style>
</head>
<body>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr bgcolor="#E5E5E5">
<td valign=center>
 <a href="index.html">
<font color="#004faf">Home</font></a>
 | <a href="classes.html">
<font color="#004faf">All&nbsp;Classes</font></a>
 | <a href="mainclasses.html">
<font color="#004faf">Main&nbsp;Classes</font></a>
 | <a href="annotated.html">
<font color="#004faf">Annotated</font></a>
 | <a href="groups.html">
<font color="#004faf">Grouped&nbsp;Classes</font></a>
 | <a href="functions.html">
<font color="#004faf">Functions</font></a>
</td>
<td align="right" valign="center"><img src="logo32.png" align="right" width="64" height="32" border="0"></td></tr></table><h1 align=center>QAxWidget Class Reference<br><small>[<a href="qaxcontainer.html">QAxContainer module</a>]</small></h1>

<p>The QAxWidget class is a QWidget that wraps an ActiveX control.
<a href="#details">More...</a>
<p>This class is part of the <b>Qt ActiveQt Extension</b>.
<p><tt>#include &lt;<a href="qaxwidget-h.html">qaxwidget.h</a>&gt;</tt>
<p>Inherits <a href="qwidget.html">QWidget</a> and <a href="qaxbase.html">QAxBase</a>.
<p><a href="qaxwidget-members.html">List of all member functions.</a>
<h2>Public Members</h2>
<ul>
<li class=fn><a href="#QAxWidget"><b>QAxWidget</b></a> ( QWidget&nbsp;*&nbsp;parent = 0, const&nbsp;char&nbsp;*&nbsp;name = 0, WFlags&nbsp;f = 0 )</li>
<li class=fn><a href="#QAxWidget-2"><b>QAxWidget</b></a> ( const&nbsp;QString&nbsp;&amp;&nbsp;c, QWidget&nbsp;*&nbsp;parent = 0, const&nbsp;char&nbsp;*&nbsp;name = 0, WFlags&nbsp;f = 0 )</li>
<li class=fn><a href="#QAxWidget-3"><b>QAxWidget</b></a> ( IUnknown&nbsp;*&nbsp;iface, QWidget&nbsp;*&nbsp;parent = 0, const&nbsp;char&nbsp;*&nbsp;name = 0, WFlags&nbsp;f = 0 )</li>
<li class=fn><a href="#~QAxWidget"><b>~QAxWidget</b></a> ()</li>
</ul>
<h2>Important Inherited Members</h2>
<ul>
<li class=fn>QVariant <a href="#dynamicCall"><b>dynamicCall</b></a> ( const&nbsp;QCString&nbsp;&amp;&nbsp;function, const&nbsp;QVariant&nbsp;&amp;&nbsp;var1 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var2 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var3 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var4 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var5 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var6 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var7 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var8 = QVariant ( ) )</li>
<li class=fn>QVariant <a href="#dynamicCall-2"><b>dynamicCall</b></a> ( const&nbsp;QCString&nbsp;&amp;&nbsp;function, QValueList&lt;QVariant&gt;&nbsp;&amp;&nbsp;vars )</li>
<li class=fn>QAxObject * <a href="#querySubObject"><b>querySubObject</b></a> ( const&nbsp;QCString&nbsp;&amp;&nbsp;name, const&nbsp;QVariant&nbsp;&amp;&nbsp;var1 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var2 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var3 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var4 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var5 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var6 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var7 = QVariant ( ), const&nbsp;QVariant&nbsp;&amp;&nbsp;var8 = QVariant ( ) )</li>
</ul>
<h2>Protected Members</h2>
<ul>
<li class=fn>virtual bool <a href="#createHostWindow"><b>createHostWindow</b></a> ( bool&nbsp;initialized )</li>
<li class=fn>virtual bool <a href="#translateKeyEvent"><b>translateKeyEvent</b></a> ( int&nbsp;message, int&nbsp;keycode ) const</li>
</ul>
<hr><a name="details"></a><h2>Detailed Description</h2>
<p> This class is defined in the <b>Qt <a href="activeqt.html#ActiveQt">ActiveQt</a> Extension</b>, which can be found in the <tt>qt/extensions</tt> directory. It is not included in the main Qt API.
<p>

The QAxWidget class is a <a href="qwidget.html">QWidget</a> that wraps an ActiveX control.

<p> 

<p> A QAxWidget can be instantiated as an empty object, with the name
of the ActiveX control it should wrap, or with an existing
interface pointer to the ActiveX control. The ActiveX control's
properties, methods and events which only use <a href="qaxbase.html">supported data types</a>, become available as Qt properties,
slots and signals. The base class <a href="qaxbase.html">QAxBase</a> provides an API to
access the ActiveX directly through the IUnknown pointer.
<p> QAxWidget is a QWidget and can be used as such, e.g. it can be
organized in a widget hierarchy, receive events or act as an event
filter. Standard widget properties, e.g. <a href="qwidget.html#enabled-prop">enabled</a> are supported, but it depends on the ActiveX
control to implement support for ambient properties like e.g.
palette or font. QAxWidget tries to provide the necessary hints.
<p> <b>Warning:</b>
You can subclass QAxWidget, but you cannot use the <a href="metaobjects.html#Q_OBJECT">Q_OBJECT</a> macro
in the subclass (the generated <a href="moc.html#moc">moc</a>-file will not compile), so you
cannot add further signals, slots or properties. This limitation
is due to the metaobject information generated in runtime. To work
around this problem, aggregate the QAxWidget as a member of the
<a href="qobject.html">QObject</a> subclass.
<p> 
<hr><h2>Member Function Documentation</h2>
<h3 class=fn><a name="QAxWidget"></a>QAxWidget::QAxWidget ( <a href="qwidget.html">QWidget</a>&nbsp;*&nbsp;parent = 0, const&nbsp;char&nbsp;*&nbsp;name = 0, WFlags&nbsp;f = 0 )
</h3>
Creates an empty QAxWidget widget and propagates <em>parent</em>, <em>name</em> and <em>f</em> to the <a href="qwidget.html">QWidget</a> constructor. To initialize a control,
call <a href="qaxbase.html#setControl">setControl</a>.

<h3 class=fn><a name="QAxWidget-2"></a>QAxWidget::QAxWidget ( const&nbsp;<a href="qstring.html">QString</a>&nbsp;&amp;&nbsp;c, <a href="qwidget.html">QWidget</a>&nbsp;*&nbsp;parent = 0, const&nbsp;char&nbsp;*&nbsp;name = 0, WFlags&nbsp;f = 0 )
</h3>
Creates an QAxWidget widget and initializes the ActiveX control <em>c</em>.
<em>parent</em>, <em>name</em> and <em>f</em> are propagated to the <a href="qwidget.html">QWidget</a> contructor.
<p> <p>See also <a href="qaxbase.html#control-prop">control</a>.

<h3 class=fn><a name="QAxWidget-3"></a>QAxWidget::QAxWidget ( IUnknown&nbsp;*&nbsp;iface, <a href="qwidget.html">QWidget</a>&nbsp;*&nbsp;parent = 0, const&nbsp;char&nbsp;*&nbsp;name = 0, WFlags&nbsp;f = 0 )
</h3>
Creates a QAxWidget that wraps the COM object referenced by <em>iface</em>.
<em>parent</em>, <em>name</em> and <em>f</em> are propagated to the <a href="qwidget.html">QWidget</a> contructor.

<h3 class=fn><a name="~QAxWidget"></a>QAxWidget::~QAxWidget ()
</h3>
Shuts down the ActiveX control and destroys the QAxWidget widget,
cleaning up all allocated resources.
<p> <p>See also <a href="qaxbase.html#clear">clear</a>().

<h3 class=fn>bool <a name="createHostWindow"></a>QAxWidget::createHostWindow ( bool&nbsp;initialized )<tt> [virtual protected]</tt>
</h3>
Creates the client site for the ActiveX control, and returns TRUE if
the control could be embedded successfully, otherwise returns FALSE.
If <em>initialized</em> is TRUE the control has already been initialized.
<p> This function is called by <a href="qaxbase.html#initialize">initialize</a>(). If you reimplement initialize
to customize the actual control instantiation, call this function in your
reimplementation to have the control embedded by the default client side.
Creates the client site for the ActiveX control, and returns TRUE if
the control could be embedded successfully, otherwise returns FALSE.

<h3 class=fn><a href="qvariant.html">QVariant</a> <a name="dynamicCall"></a>QAxBase::dynamicCall ( const&nbsp;<a href="qcstring.html">QCString</a>&nbsp;&amp;&nbsp;function, const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var1 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var2 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var3 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var4 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var5 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var6 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var7 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var8 = QVariant ( ) )
</h3>
Calls the COM object's method <em>function</em>, passing the
parameters <em>var1</em>, <em>var1</em>, <em>var2</em>, <em>var3</em>, <em>var4</em>, <em>var5</em>,
<em>var6</em>, <em>var7</em> and <em>var8</em>, and returns the value returned by
the method, or an invalid <a href="qvariant.html">QVariant</a> if the method does not return
a value or when the function call failed.
<p> If <em>function</em> is a method of the object the string must be provided
as the full prototype, for example as it would be written in a
<a href="qobject.html#connect">QObject::connect</a>() call.
<pre>
    activeX-&gt;dynamicCall( "Navigate(const <a href="qstring.html">QString</a>&amp;)", "www.trolltech.com" );
    </pre>
 
<p> Alternatively a function can be called passing the parameters embedded
in the string, e.g. above function can also be invoked using
<pre>
    activeX-&gt;dynamicCall("Navigate(\"www.trolltech.com\");
    </pre>
 
All parameters are passed as strings; it depends on the control whether
they are interpreted correctly, and is slower than using the prototype
with correctly typed parameters.
<p> If <em>function</em> is a property the string has to be the name of the
property. The property setter is called when <em>var1</em> is a valid QVariant,
otherwise the getter is called.
<pre>
    activeX-&gt;dynamicCall( "Value", 5 );
    <a href="qstring.html">QString</a> text = activeX-&gt;dynamicCall( "Text" ).toString();
    </pre>
 
Note that it is faster to get and set properties using
<a href="qobject.html#property">QObject::property</a>() and <a href="qobject.html#setProperty">QObject::setProperty</a>().
<p> It is only possible to call functions through <a href="qaxbase.html#dynamicCall">dynamicCall</a>() that
have parameters or return values of datatypes supported by
<a href="qvariant.html">QVariant</a>. See the <a href="qaxbase.html">QAxBase</a> class documentation for a list of
supported and unsupported datatypes. If you want to call functions
that have unsupported datatypes in the parameter list, use
<a href="qaxbase.html#queryInterface">queryInterface</a>() to retrieve the appropriate COM interface, and
use the function directly.
<p> <pre>
    IWebBrowser2 *webBrowser = 0;
    activeX-&gt;queryInterface( IID_IWebBrowser2, (void**)&amp;webBrowser );
    if ( webBrowser ) {
        webBrowser-&gt;Navigate2( pvarURL );
        webBrowser-&gt;Release();
    }
    </pre>
 
<p> This is also more efficient.

<p>Example: <a href="qaxcontainer-example-qutlook.html#x2720">qutlook/centralwidget.cpp</a>.
<h3 class=fn><a href="qvariant.html">QVariant</a> <a name="dynamicCall-2"></a>QAxBase::dynamicCall ( const&nbsp;<a href="qcstring.html">QCString</a>&nbsp;&amp;&nbsp;function, <a href="qvaluelist.html">QValueList</a>&lt;QVariant&gt;&nbsp;&amp;&nbsp;vars )
</h3>
This is an overloaded member function, provided for convenience. It behaves essentially like the above function.
<p> Calls the COM object's method <em>function</em>, passing the
parameters in <em>vars</em>, and returns the value returned by
the method. If the method does not return a value or when
the function call failed this function returns an invalid
<a href="qvariant.html">QVariant</a> object.
<p> The QVariant objects in <em>vars</em> are updated when the method has
out-parameters.

<h3 class=fn><a href="qaxobject.html">QAxObject</a>&nbsp;* <a name="querySubObject"></a>QAxBase::querySubObject ( const&nbsp;<a href="qcstring.html">QCString</a>&nbsp;&amp;&nbsp;name, const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var1 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var2 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var3 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var4 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var5 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var6 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var7 = QVariant ( ), const&nbsp;<a href="qvariant.html">QVariant</a>&nbsp;&amp;&nbsp;var8 = QVariant ( ) )
</h3>
Returns a pointer to a <a href="qaxobject.html">QAxObject</a> wrapping the COM object provided
by the method or property <em>name</em>, passing passing the parameters
<em>var1</em>, <em>var1</em>, <em>var2</em>, <em>var3</em>, <em>var4</em>, <em>var5</em>, <em>var6</em>,
<em>var7</em> and <em>var8</em>.
<p> If <em>name</em> is provided by a method the string must include the
full function prototype.
<p> If <em>name</em> is a property the string must be the name of the property,
and <em>var1</em>, ... <em>var8</em> are ignored.
<p> The returned QAxObject is a child of this object (which is either of
type QAxObject or QAxWidget), and is deleted when this object is
deleted. It is however safe to delete the returned object yourself,
and you should do so when you iterate over lists of subobjects.
<p> COM enabled applications usually have an object model publishing
certain elements of the application as dispatch interfaces. Use
this method to navigate the hierarchy of the object model, e.g.
<p> <pre>
    QAxWidget outlook( "Outlook.Application" );
    <a href="qaxobject.html">QAxObject</a> *session = outlook.<a href="qaxbase.html#querySubObject">querySubObject</a>( "Session" );
    if ( session ) {
        <a href="qaxobject.html">QAxObject</a> *defFolder = session-&gt;<a href="qaxbase.html#querySubObject">querySubObject</a>(
                                "GetDefaultFolder(OlDefaultFolders)",
                                "olFolderContacts" );
        //...
    }
    </pre>
 

<p>Example: <a href="qaxcontainer-example-qutlook.html#x2721">qutlook/centralwidget.cpp</a>.
<h3 class=fn>bool <a name="translateKeyEvent"></a>QAxWidget::translateKeyEvent ( int&nbsp;message, int&nbsp;keycode ) const<tt> [virtual protected]</tt>
</h3>
Reimplement this function to pass certain key events to the
ActiveX control. <em>message</em> is the Window message identifier
specifying the message type (ie. WM_KEYDOWN), and <em>keycode</em> is
the virtual keycode (ie. VK_TAB).
<p> If the function returns TRUE the key event is passed on to the 
ActiveX control, which then either processes the event or passes 
the event on to Qt.
<p> If the function returns FALSE the processing of the key event is
ignored by <a href="activeqt.html#ActiveQt">ActiveQt</a>, ie. the ActiveX control might handle it or
not.
<p> The default implementation returns TRUE for the following cases:
<p> <center><table cellpadding="4" cellspacing="2" border="0">
<tr bgcolor="#a2c511">
<th valign="top">WM_SYSKEYDOWN
<th valign="top">WM_SYSKEYUP
<th valign="top">WM_KEYDOWN
<tr bgcolor="#f0f0f0">
<td valign="top">All keycodes
<td valign="top">VK_MENU
<td valign="top">VK_TAB, VK_DELETE and all non-arrow-keys in combination with VK_SHIFT, 
VK_CONTROL or VK_MENU
</table></center>
<p> This table is the result of experimenting with popular ActiveX controls,
ie. Internet Explorer and Microsoft Office applications, but for some
controls it might require modification.

<!-- eof -->
<hr><p>
This file is part of the <a href="index.html">Qt toolkit</a>.
Copyright &copy; 1995-2007
<a href="http://www.trolltech.com/">Trolltech</a>. All Rights Reserved.<p><address><hr><div align=center>
<table width=100% cellspacing=0 border=0><tr>
<td>Copyright &copy; 2007
<a href="troll.html">Trolltech</a><td align=center><a href="trademarks.html">Trademarks</a>
<td align=right><div align=right>Qt 3.3.8</div>
</table></div></address></body>
</html>
